---
以下是一些重要规则，涵盖:
- 开发工作流程
- .trae 文档自我改进工作流程
- 修改或添加新章节/规则时要遵循的模板
---
开发工作流程
---
描述: 使用元开发脚本(scripts/dev.js)管理任务驱动开发工作流程的指南
文件匹配: **/*
应用规则文件: **/*
始终应用: true
---
- **全局命令行界面**
  - Task Master 现在通过 `task-master` 命令提供全局 CLI
  - `scripts/dev.js` 的所有功能都可以通过此界面使用
  - 通过 `npm install -g claude-task-master` 全局安装或通过 `npx` 本地使用
  - 使用 `task-master <命令>` 替代 `node scripts/dev.js <命令>`
  - 示例:
    - 使用 `task-master list` 替代 `node scripts/dev.js list`
    - 使用 `task-master next` 替代 `node scripts/dev.js next`
    - 使用 `task-master expand --id=3` 替代 `node scripts/dev.js expand --id=3`
  - 所有命令接受与脚本相同的选项
  - CLI 提供额外命令如 `task-master init` 用于项目设置
- **开发工作流程**
  - 通过运行 `task-master init` 或 `node scripts/dev.js parse-prd --input=<prd-file.txt>` 开始新项目以生成初始 tasks.json
  - 使用 `task-master list` 开始编码会话以查看当前任务、状态和 ID
  - 在分解任务前使用 `task-master analyze-complexity --research` 分析任务复杂度
  - 基于依赖项(全部标记为'完成')、优先级和 ID 顺序选择任务
  - 通过检查 tasks/ 目录中的任务文件或询问用户输入来明确任务
  - 使用 `task-master show <id>` 查看具体任务详情以了解实现要求
  - 使用 `task-master expand --id=<id>` 及适当的标志分解复杂任务
  - 如需要,在重新生成前使用 `task-master clear-subtasks --id=<id>` 清除现有子任务
  - 按照任务详情、依赖项和项目标准实现代码
  - 在标记完成前根据测试策略验证任务
  - 使用 `task-master set-status --id=<id> --status=done` 标记已完成任务
  - 当实现与原计划不同时更新依赖任务
  - 更新 tasks.json 后使用 `task-master generate` 生成任务文件
  - 需要时使用 `task-master fix-dependencies` 维护有效的依赖结构
  - 选择工作时遵循依赖链和任务优先级
  - 使用 list 命令定期报告进度

---
TRAE_RULES
---
描述: 创建和维护 Trae 规则以确保一致性和有效性的指南。
文件匹配: .trae
应用规则文件: .trae
始终应用: true
---
以下描述了如何在此文档中构建新的规则部分。
- **必需的规则结构:**
  ```markdown
  ---
  描述: 清晰的单行描述,说明规则强制执行的内容
  文件匹配: path/to/files/*.ext, other/path/**/*
  始终应用: boolean
  ---
  - **粗体显示的主要要点**
    - 带有详细信息的子要点
    - 示例和说明
  ```
- **章节引用:**
  - 使用 `大写_章节` 引用文件
  - 示例: `TRAE_RULES`
- **代码示例:**
  - 使用特定语言的代码块
  ```typescript
  // ✅ 推荐: 显示良好示例
  const goodExample = true;
  
  // ❌ 不推荐: 显示反模式
  const badExample = false;
  ```

- **规则内容指南:**
  - 从高层概述开始
  - 包含具体的、可操作的要求
  - 显示正确实现的示例
  - 尽可能引用现有代码
  - 通过引用其他规则保持规则的简洁性(DRY原则)

- **规则维护:**
  - 当出现新模式时更新规则
  - 从实际代码库中添加示例
  - 移除过时的模式
  - 交叉引用相关规则

- **最佳实践:**
  - 使用要点列表以保持清晰
  - 保持描述简洁
  - 包含推荐和不推荐的示例
  - 引用实际代码而非理论示例
  - 在规则间使用一致的格式

---
SELF_IMPROVE
---
描述: 基于新兴代码模式和最佳实践持续改进此规则文档的指南。
文件匹配: **/*
应用规则文件: **/*
始终应用: true
---

- **规则改进触发器:**
  - 现有规则未涵盖的新代码模式
  - 跨文件的重复相似实现
  - 可以通过规则预防的常见错误模式
  - 一致使用的新库或工具
  - 代码库中新兴的最佳实践

- **分析过程:**
  - 将新代码与现有规则进行比较
  - 识别应该标准化的模式
  - 查找对外部文档的引用
  - 检查一致的错误处理模式
  - 监控测试模式和覆盖率

- **规则更新:**
  - **添加新规则的时机:**
    - 新技术/模式在3个以上文件中使用
    - 常见错误可以通过规则预防
    - 代码审查中重复提及相同反馈
    - 出现新的安全或性能模式

  - **修改现有规则的时机:**
    - 代码库中存在更好的示例
    - 发现额外的边缘情况
    - 相关规则已更新
    - 实现细节已更改

- **示例模式识别:**
  ```typescript
  // 如果你看到重复的模式如:
  const data = await prisma.user.findMany({
    select: { id: true, email: true },
    where: { status: 'ACTIVE' }
  });
  
  // 考虑在 .trae 中添加 PRISMA 部分:
  // - 标准选择字段
  // - 常见where条件
  // - 性能优化模式
  ```

- **规则质量检查:**
  - 规则应该是可操作和具体的
  - 示例应该来自实际代码
  - 引用应该是最新的
  - 模式应该得到一致执行

- **持续改进:**
  - 监控代码审查评论
  - 跟踪常见开发问题
  - 在重大重构后更新规则
  - 添加相关文档链接
  - 交叉引用相关规则

- **规则废弃:**
  - 将过时模式标记为已废弃
  - 移除不再适用的规则
  - 更新对已废弃规则的引用
  - 记录旧模式的迁移路径

- **文档更新:**
  - 保持示例与代码同步
  - 更新对外部文档的引用
  - 维护相关规则间的链接
  - 记录破坏性更改

遵循 TRAE_RULES 以获得正确的规则格式和 trae 规则部分的结构。